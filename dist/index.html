<!doctype html>
<html>
  <head>
    <title>Autocompleter custom element use case</title>
    <script src="index.js"></script>
    <style>
    body {
      font: bold 16px/1.5 sans-serif;
      color: #f08080;
      margin: 16px;
      background-color: #c8ebd0;
    }
    svelte-autocompleter {
      color: inherit;
      font: inherit;
      --input-border-color: #add8e6;
      --input-background: #f8fcfd url('search-outline.svg') no-repeat center right 5px/4%;
      --input-border-radius: 3px;
      --input-placeholder-font: oblique normal 100 14px/1.5 sans-serif;
      --input-placeholder-color: #add8e6;
      --list-border-color: #add8e6;
      --list-border-radius: 3px;
      --listitem-border-color: #add8e6;
      --listitem-background-color: #f8fcfd;
      --listitem-highlighted-background-color: #eef9f0;
      --max-height: 150px;
    }
    form {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      grid-column-gap: 16px;
      grid-auto-flow: column;
    }
    fieldset {
      box-sizing: border-box;
      padding-right: 16px;
      padding-left: 16px;
      border-width: 0;
      border-radius: 8px;
      background-color: #e3f3f6;
    }
    </style>
  </head>
  <body>
    <h1>Autocompleter</h1>
    <p>Custom element use case</p>
    <form action="">
      <fieldset>
        <p>
        Country selected:
        <span id="selected_country_code">
          France / FRA
        </span>
        </p>
        <p>
        <svelte-autocompleter id="country_code_autocompleter"
          show="France"
          output="FRA"
          name="country_code"/>
        </p>
      </fieldset>
      <fieldset>
        <p>
        Animal selected:
        <span id="selected_animal">none</span>
        </p>
        <p>
        <svelte-autocompleter id="animal_autocompleter"
          show=""
          output=""
          name="animal"/>
        </p>
      </fieldset>
    </form>
    <script>
      cc = document.querySelector('#country_code_autocompleter');
      cc.renderlistitem = (item) => (`${item.name} (${item.alpha3Code}) <i>${item.nativeName}</i>`);
      cc.datasource = (value) => (new Request(`https://restcountries.eu/rest/v2/name/${value}`));
      cc.onselected = (item) => ({show: item.name, output: item.alpha3Code});
      cc.onkeyupfilter = (item, value) => (
        item.alpha3Code === value.toUpperCase()
        || item.name.toLowerCase().includes(value.toLowerCase())
      );
      cc.addEventListener('AUTOCOMPLETER:SELECTED', function(e) {
        el = document.querySelector('#selected_country_code');
        el.innerText = Object.values(e.detail).join(' / ');
      });
      cc.addEventListener('AUTOCOMPLETER:CLEARED', function(e) {
        el = document.querySelector('#selected_country_code');
        el.innerText = 'none';
      });

      ac = document.querySelector('#animal_autocompleter');
      ac.renderlistitem = (item) => (`${item}`);
      ac.datasource = (value) => [
        'pinguin', 'panda', 'parot', 'bear', 'dog', 'cat', 'elephant', 'bull'
      ];
      ac.onselected = (item) => ({show: item, output: item});
      ac.onkeyupfilter = (item, value) => item.includes(value);
      ac.addEventListener('AUTOCOMPLETER:SELECTED', function(e) {
        sc = document.querySelector('#selected_animal');
        sc.innerText = capitalize(e.detail.output);
      });
      ac.addEventListener('AUTOCOMPLETER:CLEARED', function(e) {
        el = document.querySelector('#selected_animal');
        el.innerText = 'none';
      });
      const capitalize = (s) => {
        if (typeof s !== 'string') return ''
        return s.charAt(0).toUpperCase() + s.slice(1)
      }
    </script>
  </body>
</html>
