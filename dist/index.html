<!doctype html>
<html>
  <head>
    <title>Autocompleter custom element use case</title>
    <script src="index.js"></script>
    <style>
    body { font: normal 16px/1.5 Arial, sans-serif; }
    svelte-autocompleter {
      --input-border-color: lightblue;
      --input-background-color: #f8fcfd;
      --input-border-radius: 3px;
      --list-border-color: lightblue;
      --list-border-radius: 3px;
      --listitem-border-color: lightblue;
      --listitem-background-color: #f8fcfd;
      --listitem-highlighted-background-color: lightblue;
      --max-height: 150px;
    }
    form {
      display: grid;
      grid-template-columns: repeat(1fr, 2);
      grid-auto-flow: column;
    }
    </style>
  </head>
  <body>
    <h1>Autocompleter custom element use case</h1>
    <form action="">
      <fieldset>
        <p>
        Country selected:
        <strong id="selected_country_code">
          France / FRA
        </strong>
        </p>
        <p>
        <svelte-autocompleter id="country_code_autocompleter"
          show="France"
          output="FRA"
          name="country_code"/>
        </p>
      </fieldset>
      <fieldset>
        <p>
        Animal selected:
        <strong id="selected_animal"></strong>
        </p>
        <p>
        <svelte-autocompleter id="animal_autocompleter"
          show=""
          output=""
          name="animal"/>
        </p>
      </fieldset>
    </form>
    <script>
      cc = document.querySelector('#country_code_autocompleter');
      cc.renderlistitem = (item) => (`${item.name} (${item.alpha3Code}) <i>${item.nativeName}</i>`);
      cc.datasource = (value) => (new Request(`https://restcountries.eu/rest/v2/name/${value}`));
      cc.onselected = (item) => ({show: item.name, output: item.alpha3Code});
      cc.onkeyupfilter = (item, value) => (
        item.alpha3Code === value.toUpperCase()
        || item.name.toLowerCase().includes(value.toLowerCase())
      );
      cc.addEventListener('AUTOCOMPLETER:SELECTED', function(e) {
        el = document.querySelector('#selected_country_code');
        el.innerText = Object.values(e.detail).join(' / ');
      });
      cc.addEventListener('AUTOCOMPLETER:CLEARED', function(e) {
        el = document.querySelector('#selected_country_code');
        el.innerText = 'none';
      });

      ac = document.querySelector('#animal_autocompleter');
      ac.renderlistitem = (item) => (`${item}`);
      ac.datasource = (value) => ['pinguin', 'bear', 'dog', 'cat', 'elephant', 'bull'];
      ac.onselected = (item) => ({show: item, output: item});
      ac.onkeyupfilter = (item, value) => item.includes(value);
      ac.addEventListener('AUTOCOMPLETER:SELECTED', function(e) {
        sc = document.querySelector('#selected_animal');
        sc.innerText = e.detail.output;
      });
      ac.addEventListener('AUTOCOMPLETER:CLEARED', function(e) {
        el = document.querySelector('#selected_animal');
        el.innerText = 'none';
      });
    </script>
  </body>
</html>
